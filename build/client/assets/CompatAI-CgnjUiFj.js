import{w as Y,a as c,p as e,v as K,R as X}from"./chunk-ZYFC6VSF-D4nDKD-E.js";import{f as _}from"./fishcompat-DFlmpG3F.js";function se(){return[{title:"AI Compatibility Calculator | AquaPi AI"},{name:"description",content:"Get an AI-powered compatibility report for your aquarium fish."}]}const Q=()=>e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-5 w-5",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M14.707 12.707a1 1 0 01-1.414 0L10 9.414l-3.293 3.293a1 1 0 01-1.414-1.414l4-4a1 1 0 011.414 0l4 4a1 1 0 010 1.414z",clipRule:"evenodd"})}),Z=({letters:R,onLetterClick:h,onScrollToTop:w})=>e.jsxs("div",{className:"fixed right-0 top-1/2 transform -translate-y-1/2 z-40 flex flex-col items-center bg-gray-900/50 p-2 rounded-l-lg backdrop-blur-sm h-auto max-h-[80vh] justify-around",children:[e.jsx("button",{onClick:w,className:"text-white text-xs font-bold p-1 w-6 h-6 flex items-center justify-center bg-black/60 hover:bg-blue-600/75 rounded-full transition-colors duration-200 mb-1",title:"Scroll to Top",children:e.jsx(Q,{})}),R.map(o=>e.jsx("button",{onClick:()=>h(o),className:"text-white text-xs font-bold p-1 w-6 h-6 flex items-center justify-center bg-black/60 hover:bg-blue-600/75 rounded-full transition-colors duration-200",children:o},o))]}),ae=Y(function(){const[h,w]=c.useState("freshwater"),[o,C]=c.useState([]),[s,N]=c.useState(null),[i,v]=c.useState(!1),[B,z]=c.useState(!0),[k,u]=c.useState(null),[A,b]=c.useState(!1),[g,H]=c.useState(null),T=c.useRef({}),S=c.useRef(null);c.useEffect(()=>{try{H(_)}catch(t){u(`Failed to fetch fish data: ${t.message}`),console.error("Failed to fetch fish data:",t)}finally{z(!1)}},[]);const j=t=>{const r=Math.random()*.1-.05;return Math.max(0,Math.min(1,t+r))},L=(t,r)=>t.compatible.includes(r.name)&&r.compatible.includes(t.name)?j(1):t.notCompatible.includes(r.name)||r.notCompatible.includes(t.name)?j(0):t.notRecommended.includes(r.name)||r.notRecommended.includes(t.name)?j(.25):t.withCaution.includes(r.name)||r.withCaution.includes(t.name)?j(.75):j(.5),P=t=>{if(t.length===0)return{groupHarmony:1,mathBreakdown:{pairs:[],harmonyEquation:"100%"}};let r=1;const a=[],f=[];if(t.length===1){const d=t[0],m=L(d,d);a.push({fishA:d.name,fishB:d.name,prob:m}),r=m,f.push(`${(m*100).toFixed(1)}%`)}else for(let d=0;d<t.length;d++)for(let m=d+1;m<t.length;m++){const l=L(t[d],t[m]);a.push({fishA:t[d].name,fishB:t[m].name,prob:l}),l<r&&(r=l),f.push(`${(l*100).toFixed(1)}%`)}const n=r,E=`min(${f.join(", ")||"100%"}) = ${(n*100).toFixed(1)}%`;return{groupHarmony:n,mathBreakdown:{pairs:a,harmonyEquation:E}}},$=t=>t>=.75?"text-green-400":t>=.5?"text-yellow-400":t>=.25?"text-orange-400":"text-red-400",M=async()=>{if(o.length===0)return;v(!0),N(null),u(null),S.current=new AbortController;const t=S.current.signal,r=[...o],{groupHarmony:a,mathBreakdown:f}=P(r);try{const E={contents:[{parts:[{text:`
        You are an aquarium expert. A user has selected a group of fish. Your task is to generate a tailored care guide and compatibility summary.

        Selected Fish: ${r.map(x=>x.name).join(", ")}
        Fish Type: ${h}
        Group Harmony Score: ${(a*100).toFixed(0)}%

        Please provide a JSON object with the following:
        1. "harmonyLabel": "Based on the Group Harmony Score of ${(a*100).toFixed(0)}%, provide a one-word label (e.g., Excellent, Good, Fair, Poor).",
        2. "harmonySummary": "Based on the Group Harmony Score of ${(a*100).toFixed(0)}%, write a brief summary of the overall compatibility of this group.",
        3.  "detailedSummary": A detailed summary of the potential interactions in this specific group of fish.
        4.  "tankSize": A recommended minimum tank size.
        5.  "decorations": Recommended decorations and setup.
        6.  "careGuide": A general care guide for this group.
        7.  "compatibleFish": A list of other fish that are compatible with ALL selected fish.
        `}]}],generationConfig:{responseMimeType:"application/json",responseSchema:{type:"OBJECT",properties:{harmonyLabel:{type:"STRING"},harmonySummary:{type:"STRING"},detailedSummary:{type:"STRING"},tankSize:{type:"STRING"},decorations:{type:"STRING"},careGuide:{type:"STRING"},compatibleFish:{type:"ARRAY",items:{type:"OBJECT",properties:{name:{type:"STRING"}},required:["name"]}}},required:["harmonyLabel","harmonySummary","detailedSummary","tankSize","decorations","careGuide","compatibleFish"]}}},m="https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=undefined";let l,p;const I=5;let y=0,D=1e3;for(;y<I;)try{if(l=await fetch(m,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(E),signal:t}),l.status===429){console.warn(`Attempt ${y+1}: API rate limit exceeded. Retrying in ${D/1e3}s.`),await new Promise(x=>setTimeout(x,D)),D*=2,y++;continue}if(!l.ok){const x=await l.text();throw new Error(`HTTP error! status: ${l.status}, body: ${x}`)}p=await l.json();break}catch(x){if(x.name==="AbortError"){console.log("Fetch aborted by user.");return}if(y>=I-1){u(`Failed to fetch: ${x.message}. Please try again.`),v(!1);return}y++}if(l&&l.ok)if(p.candidates&&p.candidates.length>0&&p.candidates[0].content&&p.candidates[0].content.parts&&p.candidates[0].content.parts.length>0){const x=p.candidates[0].content.parts[0].text,V={...JSON.parse(x),groupHarmonyScore:a,math:f};N(V),b(!0)}else u("Unexpected API response format.");else u("API call failed after several retries.")}catch(n){n.name!=="AbortError"&&(u(`An error occurred: ${n.message}`),console.error(n))}finally{v(!1)}},q=()=>{S.current&&S.current.abort(),v(!1)},U=t=>{const r=o.some(a=>a.name===t.name);C(r?o.filter(a=>a.name!==t.name):[...o,t]),N(null),b(!1)},F=()=>{C([]),N(null),b(!1)},J=t=>{var r;(r=T.current[t])==null||r.scrollIntoView({behavior:"smooth",block:"start"})},O=()=>{window.scrollTo({top:0,behavior:"smooth"})},W=c.useMemo(()=>{if(!g)return[];const t=g[h]||[],r=new Set(t.map(a=>a.name.charAt(0).toUpperCase()));return Array.from(r).sort()},[h,g]);if(B)return e.jsx("div",{className:"min-h-screen bg-[#0f1623] text-[#D8f3ff] flex items-center justify-center p-4 font-sans antialiased",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin inline-block w-16 h-16 border-4 border-[#81B2E8] border-t-transparent rounded-full"}),e.jsx("p",{className:"mt-4 text-xl text-[#D8f3ff]",children:"Loading fish data..."})]})});if(k&&!g)return e.jsx("div",{className:"min-h-screen bg-[#0f1623] text-[#D8f3ff] flex items-center justify-center p-4 font-sans antialiased",children:e.jsxs("div",{className:"text-center p-8 bg-[#75344E] text-[#D8f3ff] rounded-lg shadow-inner max-w-md",children:[e.jsx("p",{className:"font-bold text-xl",children:"Error:"}),e.jsx("p",{className:"mt-2",children:k}),e.jsx("p",{className:"mt-4",children:"Please check your internet connection and try reloading the page."})]})});let G="";return e.jsxs("div",{className:"min-h-screen bg-[#0f1623] text-[#D8f3ff] font-sans antialiased animate-fade-in",children:[e.jsx("div",{className:"sticky top-0 z-50 bg-[#0f1623]/80 backdrop-blur-sm shadow-md",children:e.jsxs("nav",{className:"container mx-auto px-6 lg:px-10 py-3 text-sm text-gray-400",children:[e.jsx(K,{to:"/",className:"hover:text-white transition-colors",children:"Home"}),e.jsx("span",{className:"mx-2",children:">"}),e.jsx("span",{className:"text-white",children:"AI Compatibility Calculator"})]})}),e.jsxs("div",{className:"p-4 sm:p-8 pb-12",children:[e.jsx(Z,{letters:W,onLetterClick:J,onScrollToTop:O}),e.jsxs("header",{className:"text-center mb-6",children:[e.jsx("h1",{className:"text-3xl sm:text-4xl md:text-5xl font-extrabold text-[#D8f3ff] drop-shadow-md",children:"AI Compatibility Calculator"}),e.jsx("p",{className:"mt-2 text-lg sm:text-xl text-[#D8f3ff]",children:"Select fish to get a compatibility report."})]}),e.jsxs("div",{className:"flex justify-center space-x-4 mb-6",children:[e.jsx("button",{onClick:()=>{w("freshwater"),F()},disabled:i,className:`px-6 py-3 rounded-full text-lg font-bold transition-all duration-300 transform hover:scale-105 ${h==="freshwater"?"bg-[#81B2E8] text-[#0f1623] shadow-lg":"bg-[#2c3e50] text-[#a7c0d1] hover:bg-[#497eb0] hover:text-white"} ${i?"cursor-not-allowed opacity-50":""}`,children:"Freshwater 🐟"}),e.jsx("button",{onClick:()=>{w("marine"),F()},disabled:i,className:`px-6 py-3 rounded-full text-lg font-bold transition-all duration-300 transform hover:scale-105 ${h==="marine"?"bg-[#81B2E8] text-[#0f1623] shadow-lg":"bg-[#2c3e50] text-[#a7c0d1] hover:bg-[#497eb0] hover:text-white"} ${i?"cursor-not-allowed opacity-50":""}`,children:"Saltwater 🐡"})]}),e.jsxs("main",{className:"max-w-full mx-auto bg-[#497eb0] rounded-3xl p-4 sm:p-8 shadow-2xl overflow-hidden",children:[s&&!A&&e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsxs("button",{onClick:()=>b(!0),disabled:i,className:`flex items-center justify-center px-6 py-3 bg-[#75344E]/60 backdrop-blur-sm hover:bg-[#75344E] text-[#D8f3ff] font-bold text-lg rounded-full shadow-lg transition-colors duration-300 transform hover:scale-105 ${i?"cursor-not-allowed opacity-50":""}`,children:[e.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542 7z"})]}),"Show Last Report"]})}),e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("h2",{className:"text-2xl md:text-3xl font-bold text-[#E19F20]",children:["Choose your ",h," fish:"]})}),e.jsx("div",{className:"grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 xl:grid-cols-6 gap-4 sm:gap-6 mb-8",children:g[h].map((t,r)=>{const a=t.name.charAt(0).toUpperCase(),f=a!==G;return f&&(G=a),e.jsxs("div",{ref:f?n=>{T.current[a]=n}:null,onClick:()=>!i&&U(t),className:`flex flex-col rounded-xl transition-all duration-300 transform hover:scale-105 hover:shadow-xl animate-scale-in ${o.some(n=>n.name===t.name)?"bg-[#75344E] ring-4 ring-[#E19F20]":"bg-[#0f1623] hover:bg-[#497eb0]"} ${i?"cursor-not-allowed opacity-60":"cursor-pointer"}`,style:{animationDelay:`${r*50}ms`},children:[e.jsx("img",{src:t.imageURL,alt:t.name,className:"w-full h-40 sm:h-24 md:h-32 object-cover rounded-t-xl",onError:n=>{n.target.onerror=null,n.target.src="https://placehold.co/400x200/4B5563/F9FAFB?text=No+Image"}}),e.jsxs("div",{className:"p-2 flex-grow flex flex-col justify-center",children:[e.jsx("p",{className:"text-base sm:text-lg font-semibold text-center text-[#D8f3ff]",children:t.name}),e.jsx("p",{className:"text-xs sm:text-sm text-[#D8f3ff] italic text-center",children:t.commonNames.join(", ")})]})]},t.name)})})]})]}),o.length>0&&e.jsx("div",{className:"fixed inset-x-0 bottom-0 z-50 p-4",children:e.jsxs("div",{className:"max-w-full mx-auto flex flex-col sm:flex-row justify-center sm:justify-between items-center gap-4",children:[e.jsxs("div",{className:"flex items-center justify-center gap-4 w-full sm:w-auto order-2 sm:order-1",children:[e.jsxs("button",{onClick:M,disabled:i,className:"w-full sm:w-auto px-6 py-3 bg-[#E19F20]/60 backdrop-blur-sm text-[#0f1623] font-bold text-lg rounded-full shadow-lg hover:bg-[#E19F20] transition-colors duration-300 disabled:bg-gray-500 disabled:cursor-not-allowed transform hover:scale-105 flex items-center justify-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V7a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),i?"Generating...":"Get Report"]}),e.jsxs("button",{onClick:F,disabled:i,className:"w-full sm:w-auto px-6 py-3 bg-[#75344E]/60 backdrop-blur-sm text-[#D8f3ff] font-bold text-lg rounded-full shadow-lg hover:bg-[#75344E] transition-colors duration-300 disabled:bg-gray-500 disabled:cursor-not-allowed transform hover:scale-105 flex items-center justify-center",children:[e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 mr-2",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Clear"]})]}),e.jsx("div",{className:"flex items-center gap-2 p-2 bg-black/40 backdrop-blur-md rounded-full shadow-lg order-1 sm:order-2 flex-wrap justify-center",children:o.map((t,r)=>e.jsx("img",{src:t.imageURL,alt:t.name,title:t.name,className:"w-12 h-12 rounded-full object-cover border-2 border-[#81B2E8] transition-all duration-300 ease-in-out transform hover:scale-110",onError:a=>{a.target.onerror=null,a.target.src="https://placehold.co/64x64/4B5563/F9FAFB?text=No+Image"}},r))})]})}),i&&e.jsxs("div",{className:"fixed inset-0 z-50 flex flex-col items-center justify-center bg-[#0f1623]/80 backdrop-blur-sm",children:[e.jsxs("div",{className:"text-center p-8",children:[e.jsx("div",{className:"animate-spin inline-block w-12 h-12 border-4 border-[#E19F20] border-t-transparent rounded-full"}),e.jsx("p",{className:"mt-4 text-lg text-[#E19F20]",children:"Generating report, please wait..."})]}),e.jsx("button",{onClick:q,className:"mt-4 px-6 py-3 bg-[#75344E]/60 backdrop-blur-sm text-[#D8f3ff] font-bold text-lg rounded-full shadow-lg hover:bg-[#75344E] transition-colors duration-300",children:"Cancel"})]}),A&&e.jsx("div",{onClick:()=>b(!1),className:"fixed inset-0 z-50 flex items-center justify-center bg-[#0f1623]/75 p-4 sm:p-8 md:py-12 animate-fade-in",children:e.jsxs("div",{onClick:t=>t.stopPropagation(),className:"relative w-full max-w-full max-h-[90vh] bg-[#497eb0] rounded-3xl shadow-2xl flex flex-col animate-fade-in-down",children:[e.jsxs("div",{className:"relative flex-shrink-0 px-6 pt-4 pb-2 text-center z-10 border-b border-[#D8f3ff]",children:[e.jsx("h3",{className:"text-2xl md:text-3xl font-extrabold text-[#E19F20]",children:"Compatibility Report"}),e.jsx("div",{className:"mt-1 text-base md:text-lg text-[#D8f3ff]",children:o.map((t,r)=>e.jsxs(X.Fragment,{children:[e.jsx("span",{className:"font-semibold",children:t.name}),r<o.length-1&&", "]},r))}),e.jsx("button",{onClick:()=>b(!1),className:"absolute top-2 right-2 sm:top-4 sm:right-4 text-[#D8f3ff] hover:text-[#E19F20] transition-colors duration-200 p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-8 w-8",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"overflow-y-auto p-6 sm:p-8",children:[k&&e.jsxs("div",{className:"text-center p-4 mb-4 bg-[#75344E] text-[#D8f3ff] rounded-lg shadow-inner",children:[e.jsx("p",{className:"font-bold",children:"Error:"}),e.jsx("p",{children:k})]}),s&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-1 gap-6 mb-6",children:e.jsxs("div",{className:"bg-[#0f1623] p-6 rounded-2xl text-center",children:[e.jsx("h4",{className:"text-2xl font-bold text-[#E19F20] mb-2",children:"Group Harmony"}),e.jsx("div",{className:`text-3xl font-bold mb-2 ${$(s.groupHarmonyScore)}`,children:s.harmonyLabel}),e.jsxs("p",{className:`text-5xl md:text-6xl font-bold mb-4 ${$(s.groupHarmonyScore)}`,children:[Math.round(s.groupHarmonyScore*100),"%"]}),e.jsxs("p",{className:"text-sm text-[#D8f3ff] mt-2",children:[s.groupHarmonyScore<.5?"This score represents the 'weakest link' or the single most problematic pairing in the group. A low score indicates a significant risk of conflict.":"This score represents the compatibility of the most challenging pair in the group. A high score indicates that all selected fish are likely to coexist peacefully.",e.jsx("br",{}),e.jsx("br",{}),e.jsx("strong",{children:"Summary:"})," ",s.harmonySummary]})]})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"border-t-2 border-[#D8f3ff] pt-6",children:[e.jsx("h4",{className:"text-2xl font-bold text-[#E19F20] mb-2",children:"Detailed Summary"}),e.jsx("p",{className:"text-lg leading-relaxed text-[#D8f3ff]",children:s.detailedSummary})]}),s.tankSize&&e.jsxs("div",{className:"border-t-2 border-[#D8f3ff] pt-6",children:[e.jsx("h4",{className:"text-2xl font-bold text-[#E19F20] mb-2",children:"Recommended Tank Size"}),e.jsx("p",{className:"text-lg leading-relaxed text-[#D8f3ff]",children:s.tankSize})]}),s.decorations&&e.jsxs("div",{className:"border-t-2 border-[#D8f3ff] pt-6",children:[e.jsx("h4",{className:"text-2xl font-bold text-[#E19F20] mb-2",children:"Decorations and Setup"}),e.jsx("p",{className:"text-lg leading-relaxed text-[#D8f3ff]",children:s.decorations})]}),s.careGuide&&e.jsxs("div",{className:"border-t-2 border-[#D8f3ff] pt-6",children:[e.jsx("h4",{className:"text-2xl font-bold text-[#E19F20] mb-2",children:"Care Guide"}),e.jsx("p",{className:"text-lg leading-relaxed text-[#D8f3ff]",children:s.careGuide})]}),s.compatibleFish&&s.compatibleFish.length>0&&e.jsxs("div",{className:"border-t-2 border-[#D8f3ff] pt-6",children:[e.jsx("h4",{className:"text-2xl font-bold text-[#E19F20] mb-4",children:"Compatible Tank Mates for Your Selection"}),e.jsx("div",{className:"flex flex-wrap justify-center gap-4 mb-4",children:o.map(t=>e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("img",{src:t.imageURL,alt:t.name,className:"w-20 h-20 rounded-full border-2 border-[#D8f3ff] object-cover mb-2",onError:r=>{r.target.onerror=null,r.target.src="https://placehold.co/64x64/4B5563/F9FAFB?text=No+Image"}}),e.jsx("span",{className:"font-semibold text-center text-sm text-[#D8f3ff]",children:t.name})]},t.name))}),e.jsx("ul",{className:"list-disc list-inside text-[#D8f3ff] columns-2 sm:columns-3 lg:columns-4",children:s.compatibleFish.map((t,r)=>e.jsx("li",{className:"mb-2",children:t.name},r))})]}),s.math&&s.math.pairs.length>0&&e.jsxs("div",{className:"border-t-2 border-[#D8f3ff] pt-6",children:[e.jsx("h4",{className:"text-2xl font-bold text-[#E19F20] mb-4",children:"Calculation Breakdown"}),e.jsxs("div",{className:"bg-[#0f1623] p-4 sm:p-6 rounded-2xl space-y-4",children:[e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-lg text-[#81B2E8]",children:"Pairwise Compatibility:"}),e.jsx("ul",{className:"list-disc list-inside text-[#D8f3ff]",children:s.math.pairs.map((t,r)=>e.jsxs("li",{children:[t.fishA," & ",t.fishB,": ",e.jsxs("span",{className:"font-mono",children:[(t.prob*100).toFixed(1),"%"]})]},r))})]}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-lg text-[#81B2E8]",children:"Group Harmony Score:"}),e.jsx("p",{className:"text-[#D8f3ff] font-mono text-sm break-words",children:s.math.harmonyEquation})]})]})]})]})]})]})]})}),e.jsx("footer",{className:"text-center p-8 text-gray-500 text-sm",children:e.jsx("p",{className:"max-w-3xl mx-auto",children:`This AI-powered tool helps you check the compatibility of freshwater and marine aquarium inhabitants. Select the fish you're interested in, and click "Get Report" to receive a detailed analysis, including recommended tank size, decorations, care guides, and potential conflict risks.`})})]})});export{ae as default,se as meta};
